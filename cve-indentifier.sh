
#!/bin/bash

# Asigna la dirección IP a la variable IP
IP="IP_ADDRESS"

# Ejecuta nmap para escanear los puertos, servicios y vulnerabilidades de la dirección IP
# y guarda los resultados en el archivo scan.txt
nmap -sV -sC  -p- -vvv -Pn --script=vuln $IP > scan.txt 

# Verificamos si se han encontrado vulnerabilidades
if grep -q "VULNERABLE" scan.txt
then
  # Mostramos un mensaje informando que se han encontrado vulnerabilidades
  echo "Se han encontrado vulnerabilidades:"

  # Mostramos cada vulnerabilidad encontrada junto con su identificación (CVE)
  grep "VULNERABLE" scan.txt | sed -r 's/^.*(CVE-[0-9]+-[0-9]+).*$/\1/'
else
  # Si no se han encontrado vulnerabilidades, mostramos un mensaje informando
  echo "No se han encontrado vulnerabilidades"
fi
